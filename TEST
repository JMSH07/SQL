#LIKE
SELECT ShipmetID,ShipperName,ShipperInvoiceNumber
FROM SHIPMENT
WHERE ShipperName LIKE 'AB*';

#SUM GROUP BY 
SELECT City, Store, Sum(Quantity) AS TotalQuantity
FROM ITEM
GROUP BY City, Store;

#Subsequery
SELECT s.ShipperName, s.DepartureDate
FROM SHIPMENT s
WHERE s.ShipmentID IN (SELECT i.ShipmentID FROM  SHIPMENT_ITEM i WHERE Value >=1000)
ORDER BY ShipperName, DepartureDate DESC;

#Join
SELECT DISTINCT ShipperName, DepartureDate
FROM SHIPMENT, SHIPMENT_ITEM, ITEM
WHERE SHIPMENT.SphimentID=SHIPMENT_ITEM.ShipmentID 
AND SHIPMENT_ITEM.ItemID=ITEM.itemID 
AND City='Singapore'
ORDER BY ShipperName, DepartureDate DESC:

#Count different combination
SELECT City, Store, COUNT(*) AS CITY_STORE COMBINATION_COUNT
FROM ITEM
GROUP BY City, Store;



#DDL
##1
CREATE TABLE ORDER_ITEM(
OrderNumber INT NOT NULL
SKU INT NOT NULL
Quantity INT NOT NULL
ExtendedPrice CURRENCY NULL,

CONSTRAINT PK_OrderNum_SKU PRIMARY KEY(OrderNumber,SKU),

CONSTRAINT FK_OrderNum FOREIGN KEY(OrderNumber)
REFERENCES RETAIL_ORDER(OrderNumber)
ON DELETE CASCADE ON UPDATE CASCADE,

CONSTRAINT FK_SKU FOREIGN KEY(SKU)
REFERENCES SKU_DATA(SKU)
ON DELIETE CASCADE ON UPDATE CASCADE
)

##2
CREATE TABLE RETAIL_ORDER(
OrderNumber Integer NOT NULL,
StoreNumber Integer NULL,
StoreZip Char(9) NULL,
OrderMonth Char(12) NOT NULL,
OrderYear Integer NOT NULL,
OrderTotal CURENCYY NULL,
CONSTRAINT RETAIL_ORDER_PK PRIMAMRY KEY(OrderNumber)
);

##3.
CREATE TABLE SKU_DATA(
SKU Integer NOT NULL
SKU_Description Char(35) NOT NULL
Department Char(30) NOT NULL
Buyer Char(30) NULL
CONSTRAINT SKU_DATA_PK PRIMARY KEY (SKU)
;
